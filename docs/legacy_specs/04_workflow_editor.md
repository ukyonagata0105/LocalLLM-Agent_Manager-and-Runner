# M04: Workflow Engine è©³ç´°è¨­è¨ˆæ›¸

> **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ID**: M04  
> **Tier**: 1 (Core - å¸¸ã«æœ‰åŠ¹)  
> **ä¾å­˜**: M01, M02  
> **è¢«ä¾å­˜**: M03, M08, M15

---

## 1. æ¦‚è¦

ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¨ãƒ‡ã‚£ã‚¿ã€‚ãƒãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®UIã€AIæ”¯æ´ã«ã‚ˆã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç”Ÿæˆã€‚

---

## 2. åˆ¶é™äº‹é …ï¼ˆgemini-request.mdåæ˜ ï¼‰

| é …ç›® | åˆ¶é™ | ç†ç”± |
|------|------|------|
| **ãƒãƒ¼ãƒ‰æ•°** | 100ä»¥ä¸Šã§LODè¡¨ç¤ºã«åˆ‡ã‚Šæ›¿ãˆ | UIãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ |
| **ãƒ‡ãƒãƒƒã‚°** | åˆæœŸã¯ãƒ­ã‚°è¡¨ç¤ºã®ã¿ï¼ˆãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆéå¯¾å¿œï¼‰ | å®Ÿè£…é›£æ˜“åº¦ |
| **ä¸¦åˆ—å®Ÿè¡Œ** | æœ€å¤§10ãƒãƒ¼ãƒ‰åŒæ™‚ | ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™ |

---

## 3. ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—

| ã‚«ãƒ†ã‚´ãƒª | ãƒãƒ¼ãƒ‰ | èª¬æ˜ |
|---------|--------|------|
| **ãƒˆãƒªã‚¬ãƒ¼** | Manual, Schedule, Webhook | é–‹å§‹æ¡ä»¶ |
| **LLM** | Chat, Summarize, Extract | AIå‡¦ç† |
| **ãƒ‡ãƒ¼ã‚¿** | Transform, Filter, Merge | ãƒ‡ãƒ¼ã‚¿æ“ä½œ |
| **I/O** | ReadFile, WriteFile, HTTP | å…¥å‡ºåŠ› |
| **åˆ¶å¾¡** | Condition, Loop, Parallel | ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ |
| **ãƒ„ãƒ¼ãƒ«** | MCP, Browser, Code | å¤–éƒ¨é€£æº |

---

## 4. UIãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

> âš ï¸ **æ”¹å–„**: å¤§è¦æ¨¡ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ã®æç”»é…å»¶å¯¾ç­–

### 4.1 LODï¼ˆLevel of Detailï¼‰è¡¨ç¤º

```typescript
interface LODSettings {
  // ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸè¡¨ç¤º
  zoomThresholds: {
    full: 0.5,      // 50%ä»¥ä¸Š: å®Œå…¨è¡¨ç¤º
    simplified: 0.3, // 30%ä»¥ä¸Š: ç°¡ç•¥è¡¨ç¤º
    minimal: 0.1     // 10%ä»¥ä¸Š: æœ€å°è¡¨ç¤º
  };
  
  // ãƒãƒ¼ãƒ‰æ•°ã«å¿œã˜ãŸè‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
  nodeCountThreshold: 100;
}
```

### 4.2 ä»®æƒ³åŒ–

```typescript
// ç”»é¢å¤–ãƒãƒ¼ãƒ‰ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¹ã‚­ãƒƒãƒ—
const visibleNodes = nodes.filter(node => 
  isInViewport(node, viewport)
);
```

---

## 5. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©

### 5.1 YAMLå½¢å¼

```yaml
id: daily-report
name: æ—¥å ±ç”Ÿæˆ
version: 1.0.0

triggers:
  - type: schedule
    cron: "0 18 * * 1-5"

nodes:
  - id: gather
    type: llm/chat
    config:
      prompt: "ä»Šæ—¥ã®ä½œæ¥­å†…å®¹ã‚’è¦ç´„ã—ã¦ãã ã•ã„"
    next: format
    
  - id: format
    type: transform
    config:
      template: "## {{date}}\n{{content}}"
    next: save
    
  - id: save
    type: io/write_file
    config:
      path: "reports/{{date}}.md"
```

---

## 6. AIæ”¯æ´

### 6.1 è‡ªç„¶è¨€èªã‹ã‚‰ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç”Ÿæˆ

```typescript
interface WorkflowGenerator {
  generate(description: string): Promise<Workflow>;
}

// ä¾‹
const workflow = await generator.generate(
  "æ¯æ—¥18æ™‚ã«Gitã®ã‚³ãƒŸãƒƒãƒˆå±¥æ­´ã‚’å–å¾—ã—ã¦æ—¥å ±ã‚’ä½œæˆ"
);
```

### 6.2 ãƒãƒ¼ãƒ‰ææ¡ˆ

```typescript
interface NodeSuggester {
  suggest(context: WorkflowContext): Promise<NodeSuggestion[]>;
}
```

---

## 7. å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³

```typescript
interface WorkflowExecutor {
  // å®Ÿè¡Œ
  execute(workflowId: string, params?: any): Promise<Execution>;
  
  // åˆ¶å¾¡
  pause(executionId: string): Promise<void>;
  resume(executionId: string): Promise<void>;
  cancel(executionId: string): Promise<void>;
  
  // çŠ¶æ…‹
  getStatus(executionId: string): ExecutionStatus;
}
```

---

## 8. UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: æ—¥å ±ç”Ÿæˆ               [â–¶ å®Ÿè¡Œ] [ğŸ’¾ ä¿å­˜]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚ â”‚ãƒãƒ¼ãƒ‰   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚                                         â”‚   â”‚
â”‚ â”‚ â° ãƒˆãƒªã‚¬ãƒ¼â”‚  â”‚  [Schedule] â”€â”€â†’ [Gather] â”€â”€â†’ [Format] â”‚   â”‚
â”‚ â”‚ ğŸ¤– LLM  â”‚  â”‚                              â”‚         â”‚   â”‚
â”‚ â”‚ ğŸ“ I/O  â”‚  â”‚                              â†“         â”‚   â”‚
â”‚ â”‚ ğŸ”§ ãƒ„ãƒ¼ãƒ«â”‚  â”‚                           [Save]      â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                         â”‚   â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ãƒ­ã‚°: [å®Ÿè¡Œä¸­] gather â†’ format                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«API

```typescript
export interface WorkflowEngineAPI {
  // ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†
  create(definition: WorkflowDefinition): Workflow;
  update(id: string, definition: WorkflowDefinition): Workflow;
  delete(id: string): void;
  list(): Workflow[];
  
  // å®Ÿè¡Œ
  execute(id: string, params?: any): Promise<Execution>;
  
  // AIæ”¯æ´
  generateFromDescription(description: string): Promise<Workflow>;
}
```

---

## 10. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| æŠ€è¡“ | ç”¨é€” | ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ |
|------|------|------------|
| **React Flow** | ãƒãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ | MIT |
| **Zustand** | çŠ¶æ…‹ç®¡ç† | MIT |
| **node-cron** | ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ | ISC |

---

*ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 2.0*
*æœ€çµ‚æ›´æ–°: 2026-01-05*
